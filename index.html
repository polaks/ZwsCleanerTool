<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–£–¥–∞–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
      background-color: #f9f9f9;
    }
    .wrapper {
      position: relative;
    }
    .highlighter {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 150px;
      padding: 10px;
      font-family: monospace;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background-color: #fffbe6;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow: hidden;
      pointer-events: none;
      color: transparent;
    }
    .highlight {
      background-color: yellow;
      color: black;
    }
    textarea {
      width: 100%;
      height: 150px;
      font-family: monospace;
      padding: 10px;
      font-size: 14px;
      background-color: transparent;
      border: 1px solid #ccc;
      border-radius: 6px;
      position: relative;
      z-index: 1;
      color: black;
    }
    button {
      padding: 10px 20px;
      margin-bottom: 10px;
      margin-right: 10px;
      cursor: pointer;
    }
    .counter {
      margin-bottom: 10px;
      font-size: 14px;
      color: #555;
    }
    #output {
      width: 100%;
      height: 100px;
      padding: 10px;
      font-family: monospace;
      font-size: 14px;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h2>üßπ –£–¥–∞–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤</h2>
  <p>–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–µ–∫—Å—Ç ‚Äî –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –ø–æ–¥—Å–≤–µ—Ç—è—Ç—Å—è, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—Å—Ç–∏—Ç—Å—è üëá</p>

  <div class="wrapper">
    <div id="highlighter" class="highlighter"></div>
    <textarea id="input" oninput="handleInput()" spellcheck="false"></textarea>
  </div>

  <div class="counter" id="counter"></div>
  <button onclick="copyOutput()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</button>
  <button onclick="clearInput()">üóë –û—á–∏—Å—Ç–∏—Ç—å</button>
  <p>–û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:</p>
  <textarea id="output" readonly></textarea>

  <script>
    const zwsRegex = /[\u200B-\u200F\uFEFF\u2060]/g;

    function handleInput() {
      const input = document.getElementById('input').value;
      const cleaned = input.replace(zwsRegex, '');
      document.getElementById('output').value = cleaned;
      updateCounter(input);
      updateHighlight(input);
    }

    function updateCounter(text) {
      const total = text.length;
      const hidden = (text.match(zwsRegex) || []).length;
      document.getElementById('counter').textContent = `–°–∏–º–≤–æ–ª–æ–≤ –≤—Å–µ–≥–æ: ${total} | –°–∫—Ä—ã—Ç—ã—Ö: ${hidden}`;
    }

    function copyOutput() {
      const output = document.getElementById('output');
      output.select();
      document.execCommand('copy');
      alert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
    }

    function clearInput() {
      document.getElementById('input').value = '';
      document.getElementById('output').value = '';
      document.getElementById('counter').textContent = '';
      document.getElementById('highlighter').innerHTML = '';
    }

    function updateHighlight(text) {
      const highlighted = text.replace(/[\u200B-\u200F\uFEFF\u2060]/g, match =>
        `<span class="highlight">[${match.charCodeAt(0).toString(16)}]</span>`
      ).replace(/</g, '&lt;').replace(/>/g, '&gt;');
      document.getElementById('highlighter').innerHTML = highlighted;
    }
  </script>
</body>
</html>
